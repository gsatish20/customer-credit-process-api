<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	
	<error-handler doc:name="global-error-handler" name="global-error-handler">
            <on-error-propagate type="APIKIT:BAD_REQUEST">
			<flow-ref doc:name="ef_setErrorResponse" doc:id="f160de29-535f-4921-aac5-8571e33561cc" name="ef_setErrorResponse"/>

            </on-error-propagate>
            <on-error-propagate type="APIKIT:NOT_FOUND">
			<flow-ref doc:name="ef_setErrorResponse" doc:id="7e4f0c2d-182e-4570-964a-26b3a194c42d" name="ef_setErrorResponse"/>

            </on-error-propagate>
            <on-error-propagate type="APIKIT:METHOD_NOT_ALLOWED">
			<flow-ref doc:name="ef_setErrorResponse" doc:id="36e644e3-a677-40fc-8b09-f0a7f2718d94" name="ef_setErrorResponse"/>

            </on-error-propagate>
            <on-error-propagate type="APIKIT:NOT_ACCEPTABLE">
			<flow-ref doc:name="ef_setErrorResponse" doc:id="ad5b2e4f-29ff-47b3-8eee-9df6efe435be" name="ef_setErrorResponse"/>

            </on-error-propagate>
            <on-error-propagate type="APIKIT:UNSUPPORTED_MEDIA_TYPE">
			<flow-ref doc:name="ef_setErrorResponse" doc:id="444aed39-878c-46ab-aa4b-d256b0662952" name="ef_setErrorResponse"/>

            </on-error-propagate>
            <on-error-propagate type="APIKIT:NOT_IMPLEMENTED">
			<flow-ref doc:name="ef_setErrorResponse" doc:id="11251dfe-c601-4b06-a1ee-36d8bacbcefa" name="ef_setErrorResponse"/>

            </on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="8e626ef6-1f71-426a-8f07-b51f09d30dc8" >
			<flow-ref doc:name="ef_setErrorResponse" doc:id="dcbc816d-dab2-4e1b-9a31-0c8148c53479" name="ef_setErrorResponse"/>
		</on-error-propagate>
        
</error-handler>
	<sub-flow name="ef_setErrorResponse" doc:id="d52e2246-bce2-4c5e-82b7-f3d57de4cc24" >
		<ee:transform doc:name="set Error Response" doc:id="79c56ae7-8a3e-4aa0-bd6c-5d2b8820b230" >
			<ee:message >
				<ee:set-payload resource="transformations\setErrorResponse.dwl" />
			</ee:message>
			<ee:variables >
				<ee:set-variable variableName="httpStatus" ><![CDATA[if(error.errorMessage.typedAttributes.statusCode != null) error.errorMessage.typedAttributes.statusCode else 500]]></ee:set-variable>
			</ee:variables>
		</ee:transform>
		<logger level="ERROR" doc:name="Error Logger" doc:id="b48a9424-98c1-42b6-b9f4-dcabbab3e587" message="#[payload]" category="com.credit.api"/>
	</sub-flow>
	
	
</mule>
